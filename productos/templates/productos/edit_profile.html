{% extends "base.html" %}
{% load static %}
{% load i18n %}

{% block content %}
<div class="container my-4">
    <div class="row">
        <div class="col-12">

            <h2 class="mb-4 text-center" style="color: var(--verde-pino); font-family: 'Playfair Display', serif;">{% trans "Editar Perfil" %}</h2>

            <!-- Mostrar mensajes -->
            {% if messages %}
                <div>
                    {% for message in messages %}
                        <div class="alert alert-{{ message.tags }} text-center">
                            {{ message }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}

            <form method="POST" enctype="multipart/form-data" class="unified-form">
                {% csrf_token %}

                <!-- Datos de usuario -->
                <h5 class="form-section-title">{% trans "Información Personal" %}</h5>
                <div class="form-grid">
                    {% for field in user_form %}
                    <div class="form-group">
                        <label class="form-label">{{ field.label }}</label>
                        {{ field }}
                        {% if field.errors %}
                            <div class="error-message">{{ field.errors.0 }}</div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>

                <!-- Datos de perfil -->
                <h5 class="form-section-title">{% trans "Información de Contacto" %}</h5>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">{{ profile_form.telefono.label }}</label>
                        {{ profile_form.telefono }}
                        {% if profile_form.telefono.errors %}
                            <div class="error-message">{{ profile_form.telefono.errors.0 }}</div>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label class="form-label">{{ profile_form.direccion.label }}</label>
                        {{ profile_form.direccion }}
                        {% if profile_form.direccion.errors %}
                            <div class="error-message">{{ profile_form.direccion.errors.0 }}</div>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label class="form-label">{{ profile_form.fecha_nacimiento.label }}</label>
                        {{ profile_form.fecha_nacimiento }}
                        {% if profile_form.fecha_nacimiento.errors %}
                            <div class="error-message">{{ profile_form.fecha_nacimiento.errors.0 }}</div>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label class="form-label">{{ profile_form.ciudad.label }}</label>
                        {{ profile_form.ciudad }}
                        {% if profile_form.ciudad.errors %}
                            <div class="error-message">{{ profile_form.ciudad.errors.0 }}</div>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label class="form-label">{{ profile_form.tipo_lana.label }}</label>
                        {{ profile_form.tipo_lana }}
                        {% if profile_form.tipo_lana.errors %}
                            <div class="error-message">{{ profile_form.tipo_lana.errors.0 }}</div>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label class="form-label">{% trans "Colores favoritos" %}</label>
                        {{ profile_form.colores_favoritos }}
                        {% if profile_form.colores_favoritos.errors %}
                            <div class="error-message">{{ profile_form.colores_favoritos.errors.0 }}</div>
                        {% endif %}
                    </div>
                </div>
                
                <!-- Mostrar todos los errores del formulario de perfil -->
                {% if profile_form.non_field_errors %}
                    <div class="alert alert-danger">
                        {{ profile_form.non_field_errors }}
                    </div>
                {% endif %}

                <!-- Botones -->
                <div class="form-actions">
                    <a href="{% url 'profile' %}" class="btn-cancel">
                        {% trans "Cancelar" %}
                    </a>
                    <button type="submit" class="btn-submit">
                        {% trans "Guardar cambios" %}
                    </button>
                </div>

            </form>
        </div>
    </div>
</div>
{% endblock %}
